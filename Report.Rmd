---
title: "Exploratory Analysis of CEO Salary Data"
author: "Felipe Campos, Stanimir Vichev, Josh Wilson"
date: "2/2/2017"
output: pdf_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
library("ggplot2")
library("gridExtra")
library("knitr")
library("car")
library(e1071)
```

# Introduction

The purpose of this exploratory data analysis is to determine whether there is an association between the salary of a chief executive officer (CEO) and the performance of the CEO’s company. To that effect, we analyzed a cross section of data gathered from a selection of different companies for the year 1990. In our analysis, we will demonstrate that there is a strong linear association between a CEO’s salary and the performance of a company, after the appropriate variable transformations have been implemented. Moreover, we will show that a CEO’s experience may also play a role in how much he or she receives in salary.

Initially we will discuss how the constructs were operationalized in the study. This will lead us into an investigation of each variable’s sample distribution. From the univariate analysis, we will discuss oddities we found in the data and the necessary steps we took to create a clean data set. Then, we explore the bivariate relationships within the data, including a section on potential confounding effects. Lastly, we reiterate our key findings in the conclusion as well as some apparent limitations to the study.  

# Operationalization of Constructs in Analysis  

It is important for the purpose of clarity to discuss the concepts used in  question and how they are operationalized in the dataset. Our key variable in this study is the CEO Salary, as it is the one we are most interested in understanding its impact on company performance, which is our dependent variable. All other variables used in this study are independent, secondary variables.

Before we can begin an analysis of the data, we have to determine the key concepts and how they were operationalized. If there is too much flexibility in how an operationalized variable can be interpreted, then the study design will be flawed and the results must be taken with a grain of salt. In our study, the salient yet undefined concept is company performance. We can define a successful company as one that has increased its market value over time and is able to consistently deliver results. Therefore, we can infer from this intuitive definition that measuring a company's market value should provide a perspective into company performance. (We note that are many different ways to calculate market value, and we cannot be sure how this term is defined in the data set.) However, many investors interpret a successful company as that which delivers high profitability versus share size. Therefore, “company performance” could also be reasonably measured by profits. 

A more meaningful measure of company performance might come from simple feature engineering. Profits as a standalone measure is fairly meaningless without taking into account the size of the company. In which case, a ratio of profits to the market value might provide unforeseen insight into the relationship of company performance and a CEO’s salary.

Hence, here are how the variables in this study were conceptually defined and operationalized for statistical analysis:

**CEO Salary:** In this study, CEO salary was operationalized by measuring what we believe is the total salary per year, excluding any type of complex bonuses, of the CEO for each company in the sample. The values in the sample are measured in $1000s (thousands of dollars). This is the key variable in our study.

**CEO Education:** We can conceptually define CEO Education as being the amount of formal education a person receives during his or her lifetime, such as holding a high school degree, college degree, graduate degree and so forth. Therefore, CEO education was operationalized as a construct with two different variables, College Education and Graduate Education, which measure whether the CEO of each company in the sample has a college or graduate degree respectively. Both are dummy variables, so their values in the samples are measured as 0 if the CEO of that company does not hold the indicated education degree or 1 if he or she does. 

**CEO Experience:** Conceptually, we could define an experienced CEO to be one who is older, and therefore has more general life and work experience. Or, we could define experience to be company specific and only include the years of work at the same company, because this would suggest intimate knowledge of the business. Or, we could measure CEO experience as the number of years the CEO has been in that position, at the same company. All of these perspectives are valid interpretations of ‘experience’, and are not mutually exclusive or exhaustive. Henceforth, the experience of the CEO was operationalized as a construct with three different variables. The first one is the CEO age, measuring how old he is. The second one is Total time within the company, which measures the time the CEO has been working for that company. The third and last one is Time as the CEO of the company, measuring his time in the company holding the role of CEO. All three variables are measured in years.

**Company Performance:** Company performance is an ambiguous construct with many different ways of being operationalized. For example, investors would view a company’s performance in terms of EPS compared to expectations, while a CEO might view performance as the minimization of cost or a decrease in the number of workplace injuries. A myriad of possible perspectives of company performance prohibit a simple measurement from being comprehensive. In this study, we operationalized company performance by adopting two potential measurements of company performance: profits and market value, both of them measured in millions of dollars. Since we are dealing with a cross section from 1990, we do not have year-over-year changes in market value. 

# Data and Univariate Analysis

We begin our study by loading the data gathered from the companies being studied and analyzing the main variables available.

```{r data load and summary}
load("ceo_w203.RData")
names(CEO)
```

In the dataset used in this report, we have the following data measured from selected companies:

- **CEO Salary**, which is the compensation for the CEO in the year 1990, measured in thousands of dollar;
- **CEO Age**, measuring the age of the CEO in years;
- **CEO College Education**, indicating whether the CEO completed college education, being 1 for yes and 0 for no;
- **CEO Graduate Education**, indicating whether the CEO completed graduate level education, being 1 for yes and 0 for no;
- **CEO Total Time Within Company**, which measures the time the CEO has been an employee of that company in years;
- **CEO Time Within Company as CEO**, measuring the time the CEO has held that position in the company in years;
- **Company Profitability**, which measures the profitability for that company in the year of 1990 in millions of dollars;
- **Company Market Value**, indicating the market value for the company in the year of 1990 in millions of dollars;

Each of theses variables will be now thoroughly analyzed and discussed independently.

## CEO Salary

The histogram of the dependent variable salary shown below uncovers several important features about the salary sample:

```{r salary histogram}
salary_hist <- ggplot(data = CEO, aes(x = salary)) + geom_histogram(fill = "white", colour = "black", bins = 40) + xlab("Salary in USD (1000s)") + ylab("Frequency") + 
  labs(title="Distribution of CEO Salary") +
  theme(legend.position = c(1,1), legend.justification= c(1,1), legend.background = element_blank(),
  plot.title = element_text(hjust = .5)) + 
  geom_vline(aes(xintercept=mean(salary), colour = "mean"), linetype = "dashed") + 
  geom_vline(aes(xintercept=median(salary), colour = "median"), linetype = "dashed") + 
  scale_color_manual(name = "Statistics", values = c(median = "blue", mean = "red")) +
  scale_x_continuous(breaks = c(0, 1000, 2000, 3000, 4000, 5000)) + scale_y_continuous(breaks = c(0, 5, 10, 15, 20, 25, 30))
salary_hist
```

All salaries are non-negative, which follows our general expectations, with the distribution displaying a strong positive skew. It is illustrated by the leftmost values of the graph being approximately 1.5 standard deviations from the mean, while the rightmost value is approximately 9 standard deviations from the mean. 

While many of the salaries collect into bins between $500 and $1000, one or more possible outliers visibly affect the value of the mean with respect to the median. The clear outlier may tell an interesting story or could be an error, so for now we just label it the “rich ceo”. This evidence leads us to reason that the salary distribution is non-normal and will require logarithmic transformation, especially if we are to use models that assume normally distributed variables.

## Company Market Value

```{r}
mktval_hist <- ggplot(data = CEO, aes(x=CEO$mktval)) + 
  geom_histogram(fill = "white", colour = "black", bins = 40) + xlab("Market Value in USD (Millions)") + ylab("Frequency") + 
  labs(title="Distribution of Market Value") +
  theme(legend.position = c(1,1), legend.justification= c(1,1), legend.background = element_blank(),
  plot.title = element_text(hjust = .5)) + 
  geom_vline(aes(xintercept=mean(CEO$mktval, na.rm = T), colour = "mean"), linetype = "dashed") + 
  geom_vline(aes(xintercept=median(CEO$mktval, na.rm = T), colour = "median"), linetype = "dashed") + 
  scale_color_manual(name = "Statistics", values = c(median = "blue", mean = "red")) +
  scale_x_continuous(breaks = c(0, 5000, 10000, 15000, 20000, 25000, 30000, 35000, 40000, 45000)) + 
  scale_y_continuous(breaks = c(0, 10, 20, 30, 40, 50, 60))
mktval_hist

sd(CEO$mktval, na.rm = T)
kurtosis(CEO$mktval, na.rm=T)
```

The market value histogram shown above appears in line with our intuition about the stock market; most companies have lower market values around $7m, with only a few going above $2.5b. Furthermore, the histogram shows that companies with very large market values (above $4b) are rare and can be considered as potential outliers, as a host of values are greater than three standard deviations from the mean. Therefore, these “rich companies” can have an interesting effect on our analysis and should be considered carefully. The presence of these outliers creates a heavy right tail and the extreme peak towards the lower end of the market value spectrum suggests that a log transformation will be needed to accommodate issues of potential heteroskedasticity.

While investigating the market value variable, we found that there were certain companies with a market value of negative one, seen on the left of the histogram. As it is impossible for a company to have negative market value and there aren’t any other negative values for this variable, we reasoned that negative one could probably be a coding issue to represent missing data. Comparing the histograms of the market value variable with and without the negative one rows, we see a small shift in the distribution of the variable near zero, together with a small increase of the mean. As we removed a few values close to zero, this small shift is to be expected.


## Company Profitability
```{r}
profits_hist <- ggplot(data = CEO, aes(x = profits)) + 
  geom_histogram(fill = "white", colour = "black", bins = 40) + 
  xlab("Profits in USD (Millions)") + ylab("Frequency") +
  labs(title="Distribution of Company Profits in USD (Millions)") +
  theme(legend.position = c(1,1), legend.justification= c(1,1), legend.background = element_blank(),
  plot.title = element_text(hjust = .5)) + 
  geom_vline(aes(xintercept=mean(CEO$profits, na.rm = T), colour = "mean"), linetype = "dashed") + 
  geom_vline(aes(xintercept=median(CEO$profits, na.rm = T), colour = "median"), linetype = "dashed") + 
  scale_color_manual(name = "Statistics", values = c(median = "blue", mean = "red")) +
  scale_x_continuous(breaks = c(-500, 0, 500, 1000, 1500, 2000, 2500, 3000)) + 
  scale_y_continuous(breaks = c(0, 10, 20, 30, 40, 50, 60))
profits_hist

mean(CEO$profits, na.rm = T)
sd(CEO$profits, na.rm=T)
kurtosis(CEO$profits, na.rm=T)
```

The distribution of profits is extraordinarily peaked near the zero value. Many of the companies in the sample do not make profits over 50 million, and a handful of companies are even in the red (as far as $463 million!). The skew of the distribution is very positive, pulling the mean up above 200, despite the prevalence of many values near zero. The peakedness and skew are confirmed by a very high value for kurtosis, above 11. The spread for the distribution is also rather large, at nearly 400. Even with a large standard deviation, there are many values over three standard deviations away from the mean in the positive direction. These outliers and the general shape of the profit distribution demand a transformation.

In conducting a routine inspection of the profits data and given the possible coding issues we have previously found while analyzing market value, we discovered that there were five observations that contained negative one for Profits as well. We were also able to confirm that these are the same five rows that have negative one for their market value, as shown below:

```{r}
knitr::kable(CEO[which(CEO$mktval == -1 & CEO$profits == -1),], 
             col.names = c("Salary","Age","College","Grad.","Comp. Ten.","CEO Ten.","Profits","Mkt. Value"), 
             format = "latex")
```

However, by examining the range of the profit variable, we notice that there are other negative values. In fact, these other values appear reasonable since, unlike with market value, companies can have negative profits for a specific year in which their costs exceed their revenues. Nonetheless, as only the aforementioned five rows had profits of negative one, we reason that negative one represents missing profit value as well. Comparing the profit histograms with and without these rows, we can see that the impact of excluding these observations has a marginal effect on the shape of the distribution as well as the descriptive statistics.

We applied a log10 scale and added 500 to shift everything to the right. As profits can be negative, we don't see that much of a positive skew in this graph, shown below. There are again outliers present on both sides, with a lot of companies with profits around 500. The standard deviation of profits is 401, which explains why the distribution is so wide.

<R chunk with transformed histogram>

## CEO Age

```{r, warning = FALSE}
age_hist <- ggplot(data = CEO, aes(x = age)) +
  geom_histogram(fill = "white", colour = "black", bins = 40) + 
  xlab("Years") + ylab("Frequency") +
  labs(title="Distribution of CEO Age") +
  theme(legend.position = c(1,1), legend.justification= c(1,1), legend.background = element_blank(),
  plot.title = element_text(hjust = .5)) + 
  geom_vline(aes(xintercept=mean(age), colour = "mean"), linetype = "dashed") + 
  geom_vline(aes(xintercept=median(age), colour = "median"), linetype = "dashed") + 
  scale_color_manual(name = "Statistics", values = c(median = "blue", mean = "red")) +
  scale_x_continuous(breaks = seq(20,90,5))
age_hist

sd(CEO$age)
kurtosis(CEO$age)
```

The distribution of the age variable in the sample appears fairly symmetric and normal, as the mean and median are close together. Furthermore, the kurtosis of the variable signifies that age might be viewed more as a logistic distribution rather than a normal one. The high peak at the center suggests that there may be an optimal age range for becoming a CEO: between 50 and 65. However, the sparseness in CEOs below 30 and over 75 is an important feature of the distribution; these points are over two standard deviations away from the mean. An ad hoc story is readily available: it is reasonable to infer that people below 30 may lack the requisite experience to lead publicly-traded companies, while people above 75 may not be able to handle the rigors of such a demanding position. While the points above 75 and below 30 years may represent outliers, it would be unreasonable to exclude them. It is possible that the lack of observations in these buckets is an artifact of the sample.

## CEO Education

For categorical variables such as college and grad school, we examined their frequency distribution using tables. Those tables are shown below:

```{r}
CEO$college <- as.factor(CEO$college)
CEO$grad <- as.factor(CEO$grad)
levels(CEO$grad) <- c("No Graduation", "Graduation")
levels(CEO$college) <- c("No College", "College")
kable(table(CEO$college, CEO$grad), format = "latex")
```

Evident from the table is that less than 4% of the CEOs in the sample didn't graduate from college. It would seem that post-secondary education is a necessary attribute for a CEO; this is not a surprising attribute of the data since performance in school tends to be an indicator of work ethics and/or intelligence. Moreover, boards that choose CEOs tend to prefer credentialed individuals as a means of mitigating risk. Meanwhile, the split between college and a post-tertiary degree are much closer. Meanwhile, there is less evidence to suggest that a post-tertiary degree confers much additional advantage over a college degree in becoming a CEO. While more education would be considered beneficial within the general population, it could be the case that extensive work and leadership experience is more valuable when senior management positions are filled. That is, the position for CEO tends to attract or possibly require highly educated individuals.

Finally, there are two CEOs that went to grad school, but not to college, which seems highly unlikely to be true. It is possible to imagine situations where people who have not gone to college go on to get honorary degrees from universities for special achievements, thus falling in the above case. However, since we have no information on the way the data was gathered, we cannot assume such honorary degrees were included in the study. Furthermore, these two CEOs seem to be almost exactly the same, apart from the age, as seen in their records from the sample shown below: 

```{r}
# Return levels to original value
kable(CEO[c(16,51),], 
      col.names = c("Salary","Age","College","Grad.","Comp. Ten.","CEO Ten.","Profits","Mkt. Value"),
      format = "latex")
```

We suspect that this might be a case of erroneous entry that was recorded twice, meaning that these entries should be excluded from the analysis. As the comparison between the dirty (including two entries) and the clean data shows, the omission of these two variables does not have a meaningful effect on the results drawn from the study. 


## CEO History Within the Company

We will analyze the variables indicating the total time of the CEO as an employee of the company and the duration of his tenure as a CEO.

The total company tenure variable appears to have a bimodal distribution, with one peak near 33 years and another at just under 10 years experience, as we can see from the red colored fill in the histogram below:

```{r, warning = FALSE, message = FALSE}
ten_ceo_hist <- ggplot(data = CEO) + geom_histogram(aes(x = comten, fill = "comten"), alpha = 0.3, position = "identity") +
  geom_histogram(aes(x = ceoten, fill = "ceoten"), alpha = 0.3, position = "identity") + 
  scale_fill_manual(values = c(comten = "red", ceoten = "green"), labels = c(comten = "Total", ceoten = "As CEO")) +
  theme(legend.position = c(1,1), legend.justification= c(1,1), legend.background = element_blank(),
        plot.title = element_text(hjust = .5)) +
  labs(title = "Distribution of Years as CEO and of Years at Company", fill = "Tenure Type") +
  xlab("Years") + ylab("Count") +
  geom_vline(aes(xintercept=mean(comten), colour = "meancom"), linetype = "dashed") +
  geom_vline(aes(xintercept=mean(ceoten), colour = "meanceo"), linetype = "dashed") + 
  scale_color_manual(name = "Statistics", values = c(meancom = "blue", meanceo = "red"), labels = c(meancom = "Total", meanceo = "As CEO")) +
  scale_x_continuous(breaks = c(0,10,20,30,40,50,60)) + scale_y_continuous(breaks = seq(0,35,5))
ten_ceo_hist
kurtosis(CEO$comten)
```

While a kurtosis of negative one suggests that we might be dealing with a more uniformly distributed sample, a quick visual inspection shows that this might be misleading. There may be two populations within this variable: one could be people who were hired externally at an already high position before moving up, while the other could include dedicated workers that were chosen internally after climbing up the ranks. The mean company tenure of a CEO is just over 20 years with a very large standard deviation of approximately 12. This fact, combined with the above findings, suggests that longer tenures don’t necessarily guarantee a CEO position. There is a small right tail that slightly skews the distribution, which denotes a CEO that has committed almost an entire lifetime to a company.

The CEO tenure variable has a heavily, positively skewed distribution with most of the CEOs having tenure under 10 years, as seen in the green fill in the histogram above. It would be interesting to investigate whether a major economic or political event happening around 1989 could have forced many companies to change their CEOs. The mean and standard deviation of the variable are nearly equal at about 7 years. Given how bunched the data is around the mean, the long right tail and some outliers seem to be responsible for the inflated average. This is also evidenced by the median being less than the mean. Kurtosis is highly positive, agreeing with the peaked nature of the histogram. None of the CEOs in the sample have been CEO for longer than 40 years. 

To guarantee data quality, we checked whether any of the CEOs had worked in a company for fewer years than they were CEO there. We found one row which seems to satisfy this condition, which is show below:

```{r}
kable(CEO[CEO$comten < CEO$ceoten,], 
      col.names = c("Salary","Age","College","Grad.","Comp. Ten.","CEO Ten.","Profits","Mkt. Value"),
      format = "latex")
```

We considered this an erroneous record since it is impossible to happen in real life, possibly an error on the data gathering process. We will keep this data point for future treament.


# Data Cleansing and Transformation

During our univariate analysis, we tried to determine if there was any erroneous data that could impact our results. Apart from the above two instances in CEO Education, where we found what seemed to be a duplicate entry with the CEO having Graduate School but no College level education, the -1 values in market values and profits and the CEO who has been a CEO for longer than he or she has been an employee of the company, there weren’t any other instance of problematic data in the data set. Those possibly erroneous records are summarized in the table below: 

```{r}
errors <- c(16,51,which((CEO$comten < CEO$ceoten) | (CEO$mktval == -1 & CEO$profits == -1)))
kable(CEO[errors,], 
      col.names = c("Salary","Age","College","Grad.","Comp. Ten.","CEO Ten.","Profits","Mkt. Value"),
      format = "latex")
```

Without proper documentation from the data gathering process, we cannot assume anything about those problematic records and hence it is impossible to try to adjust them. Therefore, to avoid them from corrupting the analysis, those data points were removed prior to bivariate analysis. As stated previously during the univariate analysis of each variable, the removal of those records did not alter the descriptive statistical meaningfully.

```{r}
CEO_complete <- CEO[-errors,]
```

The univariate analysis of the variables also demonstrated that some key variables appear to have skewed distributions. Specifically, salary, profit, and market value all have positively skewed distributions, which is to be expected when dealing with income-related variables. In order to clearly visualize and to understand the relationship between these variables, we applied a log transformation. This nonlinear transformation should assist us in detecting any linear relationships, if they exist.

The log transformed histogram for salary appears to resemble a normal distributed variable more closely, as shown below:

```{r}
salary_hist_final <- ggplot(data = CEO_complete, aes(x = log10(salary))) + geom_histogram(fill = "white", colour = "black", bins = 40) + xlab("Log Salary in USD (1000s)") + ylab("Frequency") + 
  labs(title="Histogram of CEO Salary on Log Scale") +
  theme(legend.position = c(1,1), legend.justification= c(1,1), legend.background = element_blank(),
  plot.title = element_text(hjust = .5)) + 
  geom_vline(aes(xintercept=mean(log10(salary)), colour = "mean"), linetype = "dashed") + 
  geom_vline(aes(xintercept=median(log10(salary)), colour = "median"), linetype = "dashed") + 
  scale_color_manual(name = "Statistics", values = c(median = "blue", mean = "red")) #+
  #scale_x_continuous(breaks = c(0, 1000, 2000, 3000, 4000, 5000)) + scale_y_continuous(breaks = c(0, 5, 10, 15, 20, 25, 30))
salary_hist_final
```

The same cannot be said of the transformed market value and profit variables. The market value histogram displayed below shows marked improvement because the very long tail has been substantially reduced. However, the distribution retained some of its positive skew and appears lognormally distributed.

```{r}
mktval_hist_final <- ggplot(data = CEO_complete, aes(x=log10(mktval))) + 
  geom_histogram(fill = "white", colour = "black", bins = 40) + xlab("Market Value in USD (Millions) Log Scale") + ylab("Frequency") + 
  labs(title="Histogram of Market Value on Log Scale") +
  theme(legend.position = c(1,1), legend.justification= c(1,1), legend.background = element_blank(),
  plot.title = element_text(hjust = .5)) + 
  geom_vline(aes(xintercept=mean(log10(CEO_complete$mktval)), colour = "mean"), linetype = "dashed") + 
  geom_vline(aes(xintercept=median(log10(CEO_complete$mktval)), colour = "median"), linetype = "dashed") + 
  scale_color_manual(name = "Statistics", values = c(median = "blue", mean = "red"))
mktval_hist_final

```

Similar to the market value transformation, the resulting histogram of the profit variable shown below is less skewed than before, however, there remains a massive peak that is cause for concern. Since logarithmic transformations cannot handle negative values, we added a constant greater than the minimum value to each instance of profit. Moreover, much of the data is very tightly bunched and this will cause some non-constant variance issues for modeling, especially considering the presence of some potential influential outliers. The log transformations are rather interpretable for the profits and market value, but if we were insistent on models with strict assumptions of normality, we could attempt a box-cox transformation.

```{r}
profits_hist_final <- ggplot(data = CEO_complete, aes(x = log10(profits + 500))) + 
  geom_histogram(fill = "white", colour = "black", bins = 60) + 
  xlab("Log Profits in USD (Millions)") + ylab("Frequency") +
  labs(title="Histogram of Company Profits in USD (Millions) Log Scale") +
  theme(legend.position = c(1,1), legend.justification= c(1,1), legend.background = element_blank(),
  plot.title = element_text(hjust = .5)) + 
  geom_vline(aes(xintercept=mean(log10(CEO_complete$profits + 500)), colour = "mean"), linetype = "dashed") + 
  geom_vline(aes(xintercept=median(log10(CEO_complete$profits + 500)), colour = "median"), linetype = "dashed") + 
  scale_color_manual(name = "Statistics", values = c(median = "blue", mean = "red")) #+
  #scale_x_continuous(breaks = c(-500, 0, 500, 1000, 1500, 2000, 2500, 3000)) + 
  #scale_y_continuous(breaks = c(0, 10, 20, 30, 40, 50, 60))
profits_hist_final
```

Lastly, the separate variables College Education and Graduate Education have been merged into a single variable, indicating 0 for no education, 1 for college education and 2 for graduate education, as we believe it will aid in visualization and analysis.

```{r}
# Return College and Grad level names to numeric values
levels(CEO_complete$grad) <- c(0,1)
levels(CEO_completeCEO$college) <- c(0,1)
CEO_complete$ed <- factor(as.numeric(levels(CEO_complete$college))[CEO_complete$college] + 
                            as.numeric(levels(CEO_complete$grad))[CEO_complete$grad])
levels(CEO_complete$ed) <- c("No College", "College", "Grad School")
```

# Analysis of Bivariate Relationships

We will now analyze how each of our most important variables relates to each other as to understand their influence and impact.

## Salary and Market Value

While market value and profitability can both be used as a proxy for a company’s performance, we decided to focus only on market value and explore its relationship with the salary variable. This is because we believe there could be a confounding effect between profitability and market value, which we discuss separately in a later section. Furthermore, we decided to focus on the effect of market value on salary, rather than vice versa, because these results painted a more interesting picture.

```{r}
salary_v_mktval <- ggplot(data = CEO_complete, aes(x = log10(CEO_complete$mktval), 
                                           y = log10(CEO_complete$salary))) +
  geom_point(alpha=.5) + geom_smooth() +
  xlab("Company Market Value in USD (Millions) on Log Scale") +
  ylab("CEO Salary in USD (1000s) on Log Scale") +
  theme(legend.position = c(1,1), legend.justification= c(1,1), legend.background = element_blank(),
        plot.title = element_text(hjust = .5)) +
  labs(title = "CEO Salary vs. Company Market Value on Log-Log Scale")
  
salary_v_mktval
cor(log10(CEO_complete$mktval),log10(CEO_complete$salary)) # 0.481491
```

From the scatterplot graph shown above we see that there is a positive relationship between market value and salary with a moderate slope. This is also demonstrated by the relatively high correlation of 0.481 between the two variables. While correlation doesn’t necessarily imply causation, we can still draw some limited conclusions based on these findings. 

First, companies with larger market values seem to pay out higher salaries than companies with smaller market values. As market value is determined from the number of outstanding shares and their price, this means that CEOs get rewarded for driving company growth and improving company performance. This can also mean that CEOs might demand higher remuneration for the increased demands of a larger corporation. 

Second, the distribution of the points on the graph and the fact that the relationship has only a moderate slope shows us that salary can still vary significantly for companies of similar market value. From this we can infer that a CEO’s salary may depend on other conditions as well, such as the negotiations around his contract with the board of directors. This in itself is influenced by a lot of factors: the CEO’s and boards’ negotiation skills, the salaries offered by competitors, the current economic climate, etc. 

This also helps explain certain outliers in the data, such as the “rich CEO”, who seems to be much better paid than any other CEO, even though his company’s market value is in the lower half of the data set. Next we will focus on the effect of a CEO’s qualifications and experience on their salary.

## Salary vs Education

Apart from the effects of company market value, we also decided to look at the effects of a CEO’s level of education on their salary. We decided to group the data into CEOs with no higher education, CEOs with college-level education only, and CEOs with college and grad school education, displaying it with a box plot displayed below. 

```{r}
salary_v_ed <- ggplot(data = CEO_complete, aes(x = factor(ed), y = salary))
salary_v_ed + geom_boxplot() + 
  stat_summary(fun.y="mean", geom="point", shape = 23, size =3, fill = "red") +
  xlab("Level of Education") + ylab("Salary in USD (1000s)") +
  labs(title="CEO Salary vs. Level of Education") +
  theme(legend.position = c(1,1), legend.justification= c(1,1), legend.background = element_blank(),
  plot.title = element_text(hjust = .5))
```

This allowed us to clearly show the effect every step of the education process has on salary. First, it is obvious that higher levels of education do not guarantee an increase in salary. In fact, a large portion of the CEOs with no college education are paid better than CEOs with college and grad school education. At the same time, the few outliers that are paid much better than the rest, including the aforementioned “rich CEO”, have some level of higher education. 

It is important to note that these findings don’t necessarily mean that higher education is negatively viewed by companies. They do show, however, that education might not play a big role in a company’s decision on who to hire as CEO or how much to pay them. Next we will explore any effects that experience might have on a CEO’s salary.


## Salary vs. Experience (Years as CEO)

We decided to focus on CEO tenure, rather than company tenure, as we found that this provided more interesting insights with regards to salary. The relation between both variables are shown in the plot below.

```{r}
salary_v_ceoten <- ggplot(data = CEO_complete, aes(x = CEO_complete$ceoten, y = log10(CEO_complete$salary))) +
  geom_point(position = position_jitter(width = 0.25, height = 0),alpha = 0.5) + geom_smooth() +
  xlab("Years") + ylab("Salary in USD (1000s) on Log Scale") + labs(title = "Salary vs. Years as CEO") +   scale_x_continuous(breaks = seq(0,35,5)) + 
  theme(plot.title = element_text(hjust = .5))
salary_v_ceoten
cor(CEO_complete$salary, CEO_complete$ceoten) # 0.1429477
cor(log10(CEO_complete$salary), CEO_complete$ceoten) # 0.114728
```

First, the steady upwards slope on the left side of the graph shows that CEOs tend to be rewarded with higher salaries for more years in the position during the first ten years of their work. This might be due to an agreement in their job contracts, which could include a predetermined yearly increase in salary for the first ten years or so. 

Unfortunately we don’t have a lot of data for CEOs that have been in the position longer than 12 or so years, so the conclusions drawn from this highly varied sample might not be very accurate. This lack of data could tell a story in itself, however, assuming that the data sample is representative of the overall CEO population. It looks like few CEOs remain in their company for longer than 12 years, and even fewer remain longer than 23. This could be explained by the notion that CEOs that manage to hold this demanding position and successfully lead a company for as long as 10-12 years are highly sought after by other companies and tend to switch jobs when possible. However, without more data about CEOs’ past leadership experiences in other companies, this is only an educated guess.


# Secondary Relationships

We will now analyze the effects of variables considered secondary to our study, as means to potentially find confounding effects or other interesting relationships that might be important to the story.

## Market Value versus Profitability

By plotting the market value of companies against their profitability, as shown below, we can see that there is an impressive relationship between both of them.

```{r}
mktval_v_profits <- ggplot(data = CEO_complete, aes(x = log10(CEO_complete$mktval), 
                                           y = log10(CEO_complete$profits + 500))) +
  geom_point(position = position_jitter(width = 0, height = 0.25), alpha=.5) + geom_smooth() +
  xlab("Company Market Value in USD (Millions) on Log Scale") +
  ylab("Company Profits in USD (Millions) on Log Scale") +
  theme(legend.position = c(1,1), legend.justification= c(1,1), legend.background = element_blank(),
        plot.title = element_text(hjust = .5)) +
  labs(title = "Company Market Value vs. Company Profits on Log-Log Scale")
  
mktval_v_profits
cor(log10(CEO_complete$mktval),log10(CEO_complete$profits + 500)) # 0.6988081
```

In fact, one would expect companies with high market value to be highly profitable. However, it seems unlikely for the market value of a company to be the sole reason defining the amount of profits it generates. 

Therefore, it seems that the relationship between profit and market value could be a potential source of a confounding effect given that there must be other variables not accounted for in this study that are driving both values. This relationship will be discussed later with other potential confounding effects.



Tenure as CEO vs. Age with Company Tenure

# Potential Confounding Effects in Bivariate Relationships
```{r}
CeoTen_v_tenure <- ggplot(data = CEO_complete, aes(x = CEO_complete$ceoten, 
                                           y = CEO_complete$age,
                                           colour = CEO_complete$ceoten)) +
  geom_point(position = position_jitter(width = 0.0, height = 0.25), alpha=.5) + geom_smooth() +
  xlab("Years as CEO") +
  ylab("Years on Earth") +
  theme(legend.position = c(1,0), legend.justification= c(1,0), legend.background = element_blank(),
        plot.title = element_text(hjust = .5)) +
  labs(title = "CEO Tenure vs. Age", colour ="Years at Co") +
  scale_color_gradient(low = "blue", high = "white") + scale_x_continuous(breaks = seq(0,35,5))
  
CeoTen_v_tenure
```


# On Possible Confounding Effects

We define confounding as the presence of an extraneous variable that is the cause of both the dependent and independent variables, and therefore conditioning on this extraneous variable will result in the dissipation of the association between the independent and dependent variable. There is no definitive statistical test to uncover confounding, despite the significance of the problem in social research and elsewhere. The best we can do to address this problem is to be conscientious and to try and create causal maps.

Profits is one likely contender for a confounding variable in our analysis. Market valuation can be calculated from profits and many CEO’s have a clause in their contract related to profits. Therefore, it is reasonable to believe that any association between market valuation of a company and a CEO’s salary might be explained by a company’s profits. When we run a simple linear regression of salary on market value and salary on profit, the dependent variables are statistically significant in each case. When we run a multivariate regression with both market value and profit included, we were surprised to see that market value remains statistically significant while profit does not. We take these results with a grain of salt, because have not controlled for multiple hypothesis testing, although the t values are very high, and we have not determined whether any assumptions of the model were violated. Regardless, the results do suggest some degree of confounding, albeit not necessarily in the direction we were expecting.

Also, although there is a strong relationship between market value and profits, this relationship is perhaps not a direct one. It is, however, expected and actually quite obvious that companies with higher market value would also present higher profitability. This is not a direct relationship, though, as simply having a higher market value does not by itself cause a company to deliver higher profits, or vice-versa. There is, therefore, one or more variables not taken into consideration in this study that could be affecting this relationship.

Another important potential confounding effect occurs between the variables salary and age, as we would not expect age by itself to directly influence someone's salary. Imagine, for instance, a company hiring a 60-year-old employee who has never before worked during his life. It is unimaginable that he would receive the same salary as a 60-year-old who has been working in that company for more than 30 years. Therefore, there should be other variables influencing this, such as experience. It is expected, for instance, that older employees, by having more experience, would have higher salaries. One way to prove that the relationship between salary and age is a potential confounding effect is by checking that the relationship between salary and the time as CEO and also the relationship between age and the time as CEO are all just as equally strong, meaning that age age drives the time as CEO, which in turn drives the salary.


# Conclusion

From our data analysis, it is undeniable that there is a strong relationship between the company's performance and the CEO salary. However, due to the possible confounding effects addressed earlier, this should be further investigated as to whether this impact on market value is solely due to salary. Given our previous investigations, though, this would seem rather unlikely.

There is a medium strength relationship between the company performance indicators and the CEO's experience, especially regarding their time within the company and age. So, this should be explored further. There is also a medium strength relationship between the age and the salary and the time as a CEO and the salary. 

We would be tempted to say, then, that the most successful companies do have well paid CEOs, but that happens because those CEOs are mostly people who are more experienced and therefore are well paid. Hence the conclusion that the relationship between salary and performance is most likely an indirect relationship, where the salary is impacted by a variety of variables that indicate more experienced CEOs and this set of qualities of the CEO is what actually impacts the general performance of the company. 

Additionally, it must be pointed out that the data gathered contains a sample where the vast majority of the companies are located on the lower spectrum in regard of performance, with very few data points representing companies with really great market value and profitability. For a more accurate analysis, a sample with more data points on the higher spectrum would be necessary. Also, we do not believe that a model based on the current dataset would be likely to represent a population of companies given the clear bias in the sample.



# CODE BACKUP

# Possibly including the relationship of salary in the above graph
```{r}
mktval_v_profits_v2 <- ggplot(data = CEO_complete, aes(x = log10(CEO_complete$mktval), 
                                           y = log10(CEO_complete$profits + 500),
                                           colour = log10(CEO_complete$salary))) +
  geom_point(position = position_jitter(width = 0.25, height = 0.25), alpha=.5) + geom_smooth() +
  xlab("Company Market Value in USD (Millions) on Log Scale") +
  ylab("Company Profits in USD (Millions) on Log Scale") +
  theme(legend.position = c(1,0), legend.justification= c(1,0), legend.background = element_blank(),
        plot.title = element_text(hjust = .5)) +
  labs(title = "Company Market Value vs. Company Profits on Log-Log Scale", colour ="Log Salary")
  
mktval_v_profits_v2
```


